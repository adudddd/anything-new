<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Our Sky of Dreams</title>
    <style>
        /* Styling for the night sky and interactive elements */
        body {
            margin: 0;
            padding: 0;
            background: linear-gradient(to bottom, #19073f, #331e57);
            font-family: 'Arial', sans-serif;
            color: #fff;
            overflow: hidden; /* Prevents scrollbars due to the star field */
        }

        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
        }

        #countdown {
            font-family: 'Arial', sans-serif;
            color: #ffcc5c;
            font-size: 1.2rem;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.8);
        }

        h1 {
            font-family: 'Cedarville Cursive', cursive;
            text-align: center;
            font-size: 4rem;
            margin-bottom: 30px;
            text-shadow: 0 0 10px #fff, 0 0 20px #fff, 0 0 30px #e60073, 0 0 40px #e60073;
        }

        /* The container for the star field and drawing area */
        #interactive-area {
            position: relative;
            width: 100vw;
            height: 100vh;
            z-index: 1;
            overflow: hidden; /* Hide overflow to prevent scrollbars */
        }

        #star-canvas, #zodiac-canvas, #constellation-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        /* Drawing Canvas */
        #drawingCanvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            cursor: crosshair; /* Make it clear this is a drawing area */
            z-index: 10; /* Ensure the drawing canvas is above the star field */
        }

        /* The Dream text */
        .dream-text {
            position: absolute;
            font-family: 'Dancing Script', cursive;
            font-size: 1.5rem;
            color: #ffd700; /* A golden color for the dreams */
            text-shadow: 0 0 5px #fff;
            z-index: 20;
            opacity: 0; /* Initially hidden */
            transition: opacity 0.5s ease;
        }

        .dream-text.visible {
            opacity: 1;
        }

        .color-picker {
          -webkit-appearance: none;
          -moz-appearance: none;
          appearance: none;
          width: 40px;
          height: 40px;
          border: 2px solid #fff;
          border-radius: 8px;
          cursor: pointer;
          background-color: transparent;
          padding: 0;
          box-shadow: 0 2px 5px rgba(0, 0, 0, 0.4);
          margin: 0 5px;
        }

        .color-picker::-webkit-color-swatch-wrapper {
          padding: 0;
        }

        .color-picker::-webkit-color-swatch {
          border: none;
          border-radius: 6px;
        }

        .color-picker::-moz-color-swatch {
          border: none;
          border-radius: 6px;
        }

        .tools {
            position: fixed;
            bottom: 20px;
            right: 20px;
            display: flex;
            align-items: center;
            z-index: 30;
        }

        /* Tool Buttons */
        .tools button {
            padding: 10px 20px;
            margin: 0 5px;
            border: none;
            background-color: #e60073; /* Pink color for tools */
            color: #fff;
            font-weight: bold;
            cursor: pointer;
            border-radius: 5px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
            transition: background-color 0.3s ease;
        }

        .tools button:hover {
            background-color: #ff3399;
        }

        /* Shooting Star */
        @keyframes shooting {
            0% {
                transform: translateX(0) translateY(0) rotate(-45deg);
                opacity: 1;
            }
            100% {
                transform: translateX(300px) translateY(-300px) rotate(-45deg);
                opacity: 0;
            }
        }

        .shooting-star {
            position: absolute;
            width: 100px;
            height: 3px;
            background: linear-gradient(to right, white, transparent);
            animation: shooting 2s linear;
            cursor: pointer;
        }

        .wish-text {
            position: absolute;
            font-family: 'Arial', sans-serif;
            font-size: 1rem;
            color: #fff;
            text-shadow: 0 0 5px #fff;
            z-index: 20;
            opacity: 0;
            transition: opacity 2s ease-in-out;
        }

        .hidden {
            display: none;
        }

        /* Audio Control */
        .audio-control {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 30;
        }

        /* Share Button */
        .share-button {
            padding: 10px 20px;
            margin: 0 5px;
            border: none;
            background-color: #e60073; /* Pink color for tools */
            color: #fff;
            font-weight: bold;
            cursor: pointer;
            border-radius: 5px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
            transition: background-color 0.3s ease;
        }

        .share-button:hover {
            background-color: #ff3399;
        }

        .star-glow {
            box-shadow: 0 0 15px 5px white;
        }

        .line-glow {
            filter: drop-shadow(0 0 5px white);
        }

        #constellation-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 5; /* Below the drawing canvas but above other elements */
        }

    </style>
    <link href="https://fonts.googleapis.com/css2?family=Cedarville+Cursive&family=Dancing+Script&display=swap" rel="stylesheet">
</head>
<body>
    <div class="header-container">
        <div id="countdown"></div>
        <h1>Our Sky of Dreams</h1>
    </div>

    <div id="interactive-area">
        <canvas id="zodiac-canvas"></canvas>
        <canvas id="star-canvas"></canvas>
        <canvas id="constellation-canvas"></canvas>
        <canvas id="drawingCanvas"></canvas>
    </div>

    <audio id="backgroundMusic" loop>
        <source src="https://audio.jukehost.co.uk/S96cEVMiNhw6hL54HkEdfR9c8yqIHVlO.mp3" type="audio/mpeg">
        Your browser does not support the audio element.
    </audio>

    <button id="toggleMusic" class="audio-control">
        <svg id="speakerIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#ffffff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
            <path id="wave1" d="M15.54 8.46a5 5 0 0 1 0 7.07"></path>
            <path id="wave2" d="M19.07 4.93a10 10 0 0 1 0 14.14"></path>
        </svg>
        <svg id="muteIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#ffffff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
            <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
            <line x1="23" y1="9" x2="17" y2="15"></line>
            <line x1="17" y1="9" x2="23" y2="15"></line>
        </svg>
    </button>
    

    <div class="tools">
        <input type="color" id="colorPicker" class="color-picker" value="#ffb6c1">
        <button id="drawLine">Connect Stars</button>
        <button id="shareSky" class="share-button">Share Your Sky</button>
    </div>

    <script>
        // New Year Countdown Timer
        const countdownDisplay = document.getElementById("countdown");

        function updateCountdown() {
            const now = new Date();
            const newYear = new Date(now.getFullYear() + 1, 0, 1);
            const diff = newYear - now;

            const days = Math.floor(diff / (1000 * 60 * 60 * 24));
            const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((diff % (1000 * 60)) / 1000);

            countdownDisplay.textContent = `Time until New Year: ${days}d ${hours}h ${minutes}m ${seconds}s`;

            if (diff <= 0) {
                countdownDisplay.textContent = "Happy New Year!";
                clearInterval(countdownInterval);
            }
        }

        const countdownInterval = setInterval(updateCountdown, 1000);
        updateCountdown();

        // Function to create a star element with animation
        function createStar(x, y, color) {
            const star = document.createElement('div');
            star.style.position = 'absolute';
            star.style.left = `${x}px`;
            star.style.top = `${y}px`;
            star.style.width = '2px';
            star.style.height = '2px';
            star.style.backgroundColor = color;
            star.style.boxShadow = `0 0 10px ${color}`;
            star.style.borderRadius = '50%';
            star.style.opacity = '0';
            star.style.transition = 'opacity 1s ease-in-out';
            document.getElementById('interactive-area').appendChild(star);
            
            // Trigger the animation
            setTimeout(() => {
                star.style.opacity = Math.random() * 0.5 + 0.5;
            }, 100);
        
            return star;
        }

        // Generate random stars on the canvas
        function generateStars(numStars) {
            const canvas = document.getElementById('star-canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;

            for (let i = 0; i < numStars; i++) {
                const x = Math.random() * canvas.width;
                const y = Math.random() * canvas.height;
                const radius = Math.random() * 1.5;
                const color = '#FFFFFF';

                ctx.beginPath();
                ctx.arc(x, y, radius, 0, Math.PI * 2, false);
                ctx.fillStyle = color;
                ctx.shadowColor = color;
                ctx.shadowBlur = Math.random() * 10;
                ctx.fill();
            }
        }

        // Initialize the stars
        generateStars(100);

        function drawZodiacConstellations() {
            const canvas = document.getElementById('zodiac-canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.5)';
            ctx.lineWidth = 1;
        
            // Define constellations with named stars and line connections
            const constellations = {
                Aries: {
                    stars: [[100, 200], [150, 250], [180, 230]],
                    lines: [[0, 1], [1, 2]]
                },
                Taurus: {
                    stars: [[300, 100], [350, 150], [380, 130], [420, 180]],
                    lines: [[0, 1], [1, 2], [2, 3]]
                },
                Gemini: {
                    stars: [[500, 200], [550, 250], [580, 230], [620, 280]],
                    lines: [[0, 1], [1, 2], [2, 3]]
                },
                Cancer: {
                    stars: [[100, 400], [150, 350], [180, 370], [220, 320]],
                    lines: [[0, 1], [1, 2], [2, 3]]
                },
                Leo: {
                    stars: [[300, 500], [350, 450], [380, 470], [420, 420]],
                    lines: [[0, 1], [1, 2], [2, 3]]
                },
                Virgo: {
                    stars: [[500, 600], [550, 550], [580, 570], [620, 520]],
                    lines: [[0, 1], [1, 2], [2, 3]]
                },
                Libra: {
                    stars: [[700, 200], [750, 250], [780, 230], [820, 280]],
                    lines: [[0, 1], [1, 2], [2, 3]]
                },
                Scorpio: {
                    stars: [[900, 100], [950, 150], [980, 130], [1020, 180]],
                    lines: [[0, 1], [1, 2], [2, 3]]
                },
                Sagittarius: {
                    stars: [[1100, 200], [1150, 250], [1180, 230], [1220, 280]],
                    lines: [[0, 1], [1, 2], [2, 3]]
                },
                Capricorn: {
                    stars: [[700, 400], [750, 350], [780, 370], [820, 320]],
                    lines: [[0, 1], [1, 2], [2, 3]]
                },
                Aquarius: {
                    stars: [[900, 500], [950, 450], [980, 470], [1020, 420]],
                    lines: [[0, 1], [1, 2], [2, 3]]
                },
                Pisces: {
                    stars: [[1100, 600], [1150, 550], [1180, 570], [1220, 520]],
                    lines: [[0, 1], [1, 2], [2, 3]]
                }
            };
        
            // Function to draw a constellation
            function drawConstellation(constellation) {
                ctx.beginPath();
                constellation.stars.forEach(star => {
                    ctx.lineTo(star[0], star[1]);
                });
                ctx.stroke();
            }
        
            // Draw each constellation
            Object.values(constellations).forEach(constellation => {
                drawConstellation(constellation);
            });
        }        

        // Call the function to draw zodiac constellations
        drawZodiacConstellations();

        // Canvas for drawing
        const canvas = document.getElementById("drawingCanvas");
        const ctx = canvas.getContext("2d");
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        let drawing = false;
        let stars = [];
        let wishCounter = 0; // Counter for wishes made on shooting stars

        // Get the selected color from the color picker
        const colorPicker = document.getElementById("colorPicker");

        // Event listener to start drawing a star
        canvas.addEventListener("click", (e) => {
            if (!lineDrawingMode) {
                drawing = true;
                const rect = canvas.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                const selectedColor = colorPicker.value;

                drawStar(x, y, selectedColor);

                const dreamLabel = prompt("Enter a dream or wish for this star:");
                if (dreamLabel) {
                    addDreamText(x, y, dreamLabel);
                }
            }
        });

        // Function to draw a star on the canvas
        function drawStar(x, y, initialColor) {
            const numPoints = 5;
            const outerRadius = 10;
            const innerRadius = 4;
            let color = initialColor;
            let colorPhase = 0; // 0 for increasing, 1 for decreasing
        
            ctx.beginPath();
            ctx.moveTo(x, y - outerRadius);
        
            for (let i = 0; i < numPoints * 2; i++) {
                const radius = i % 2 === 0 ? outerRadius : innerRadius;
                const angle = (i * Math.PI) / numPoints;
                const pointX = x + radius * Math.sin(angle);
                const pointY = y - radius * Math.cos(angle);
                ctx.lineTo(pointX, pointY);
            }
        
            ctx.closePath();
            ctx.fillStyle = color;
            ctx.shadowColor = color;
            ctx.shadowBlur = 10;
            ctx.fill();
        
            const starElement = createStar(x, y, initialColor);
            stars.push({ x, y, color: initialColor, element: starElement });
        
            // Set up color cycling
            setInterval(() => {
                color = cycleColor(color, colorPhase);
                starElement.style.backgroundColor = color;
                starElement.style.boxShadow = `0 0 10px ${color}`;
                colorPhase = (colorPhase + 1) % 360;
            }, 100); // Change color every 100 milliseconds
        
            starElement.addEventListener('mouseover', () => {
                showDreamText(x, y);
                highlightConstellation(x, y);
            });
        
            starElement.addEventListener('mouseout', () => {
                hideDreamText();
            });
        }

        function cycleColor(currentColor, phase) {
            let r, g, b;
        
            // Convert current color to RGB
            if (currentColor.startsWith('#')) {
                const hex = currentColor.substring(1);
                r = parseInt(hex.substring(0, 2), 16);
                g = parseInt(hex.substring(2, 4), 16);
                b = parseInt(hex.substring(4, 6), 16);
            } else if (currentColor.startsWith('rgb')) {
                [r, g, b] = currentColor.match(/\d+/g).map(Number);
            }
        
            // Cycle the color with a gentle change in hue
            const newColor = `hsl(${phase}, 100%, 50%)`;
        
            return newColor;
        }
        
        // Add a global variable to track added dream texts
        let dreamTexts = [];

        // Function to add dream text next to a star
        function addDreamText(x, y, text) {
            const dreamText = document.createElement("div");
            dreamText.className = "dream-text";
            dreamText.style.left = `${x + 20}px`;
            dreamText.style.top = `${y - 10}px`;
            dreamText.textContent = text;
            document.getElementById("interactive-area").appendChild(dreamText);
        
            // Store the dream text and its position
            dreamTexts.push({ text: dreamText, x: x, y: y });
        }

        function showDreamText(x, y) {
            for (let dreamText of dreamTexts) {
                // Check if the mouse is near the star (within a certain radius)
                const distance = Math.sqrt((x - dreamText.x) ** 2 + (y - dreamText.y) ** 2);
                if (distance < 20) {
                    dreamText.text.classList.add('visible');
                    break; // Show only one dream text at a time
                }
            }
        }
        
        function hideDreamText() {
            for (let dreamText of dreamTexts) {
                dreamText.text.classList.remove('visible');
            }
        }

        function highlightConstellation(x, y) {
            // Find the clicked star
            const clickedStar = findClickedStar(x, y);
            if (!clickedStar) return;

            // Reset all stars and lines to their default state
            stars.forEach(star => {
                star.element.classList.remove('star-glow');
            });
            const lines = document.querySelectorAll('.constellation-line');
            lines.forEach(line => {
                line.classList.remove('line-glow');
                line.style.opacity = 0; // Hide the line
            });

            // Find connected stars (stars connected to the clicked star)
            const connectedStars = findConnectedStars(clickedStar);

            // Highlight connected stars
            connectedStars.forEach(star => {
                const starElement = stars.find(s => s.x === star.x && s.y === star.y).element;
                starElement.classList.add('star-glow');
            });

            // Highlight lines connecting these stars
            highlightLines(clickedStar, connectedStars);
        }

        function findConnectedStars(clickedStar) {
            // Find stars directly connected to the clicked star
            const connected = connectedLines.filter(line => {
                return (line.star1.x === clickedStar.x && line.star1.y === clickedStar.y) ||
                       (line.star2.x === clickedStar.x && line.star2.y === clickedStar.y);
            }).map(line => {
                return line.star1.x === clickedStar.x && line.star1.y === clickedStar.y ? line.star2 : line.star1;
            });
        
            // Add the clicked star itself to the list of connected stars
            connected.push(clickedStar);
        
            return connected;
        }
        
        function highlightLines(clickedStar, connectedStars) {
            connectedStars.forEach(star => {
                const lineId = `line-${clickedStar.x}-${clickedStar.y}-${star.x}-${star.y}`;
                const lineId2 = `line-${star.x}-${star.y}-${clickedStar.x}-${clickedStar.y}`;
                const lineElement = document.getElementById(lineId) || document.getElementById(lineId2);
                if (lineElement) {
                    lineElement.classList.add('line-glow');
                    lineElement.style.opacity = 1; // Make the line visible
                }
            });
        }
        
        // Modify findClickedStar to return the star object with its element reference
        function findClickedStar(x, y) {
            for (let i = 0; i < stars.length; i++) {
                const star = stars[i];
                const distance = Math.sqrt((x - star.x) ** 2 + (y - star.y) ** 2);
                if (distance <= 10) {
                    return star;
                }
            }
            return null;
        }
        
        let connectedLines = [];
        // Draw Line Tool Logic
        let lineDrawingMode = false;
        let lastStarClicked = null;

        const drawLineButton = document.getElementById("drawLine");
        drawLineButton.addEventListener("click", () => {
            lineDrawingMode = !lineDrawingMode;
            if (lineDrawingMode) {
                drawLineButton.style.backgroundColor = "#ff3399";
                drawLineButton.textContent = "Connecting...";
            } else {
                drawLineButton.style.backgroundColor = "#e60073";
                drawLineButton.textContent = "Connect Stars";
                lastStarClicked = null;
            }
            canvas.style.cursor = lineDrawingMode ? "crosshair" : "default";
        });

        canvas.addEventListener("click", (e) => {
            if (lineDrawingMode) {
                const rect = canvas.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
        
                const clickedStar = findClickedStar(x, y);
                if (clickedStar) {
                    if (lastStarClicked && lastStarClicked !== clickedStar) {
                        // Draw a line between the stars
                        drawLineBetweenStars(lastStarClicked, clickedStar);
                        lastStarClicked = null; // Reset last clicked star
                    } else {
                        // Store the clicked star
                        lastStarClicked = clickedStar;
                    }
                }
            }
        });

        // Modify drawLineBetweenStars to use color cycling
        function drawLineBetweenStars(star1, star2) {
            const lineId = `line-${star1.x}-${star1.y}-${star2.x}-${star2.y}`;
            const existingLine = document.getElementById(lineId);
        
            if (existingLine) {
                existingLine.remove();
                connectedLines = connectedLines.filter(line => line.id !== lineId);
            } else {
                const lineCanvas = document.createElement('canvas');
                lineCanvas.width = window.innerWidth;
                lineCanvas.height = window.innerHeight;
                lineCanvas.style.position = 'absolute';
                lineCanvas.style.top = '0';
                lineCanvas.style.left = '0';
                lineCanvas.style.zIndex = '15';
                lineCanvas.id = lineId;
                lineCanvas.className = 'constellation-line';
        
                document.getElementById('interactive-area').appendChild(lineCanvas);
                const lineCtx = lineCanvas.getContext('2d');
        
                lineCtx.beginPath();
                lineCtx.moveTo(star1.x, star1.y);
                lineCtx.lineTo(star2.x, star2.y);
                lineCtx.strokeStyle = 'white';
                lineCtx.lineWidth = 3;
                lineCtx.shadowColor = star1.color;
                lineCtx.shadowBlur = 10;
                lineCtx.stroke();
                lineCtx.closePath();
                lineCtx.shadowColor = 'transparent';
                lineCtx.shadowBlur = 0;
        
                connectedLines.push({ id: lineId, star1: star1, star2: star2 });
            }
        }        

        // Shooting Star Animation
        function createShootingStar() {
            const shootingStar = document.createElement('div');
            shootingStar.className = 'shooting-star';
            shootingStar.style.left = `${Math.random() * window.innerWidth}px`;
            shootingStar.style.top = `${Math.random() * window.innerHeight / 2}px`;

            document.getElementById('interactive-area').appendChild(shootingStar);

            shootingStar.addEventListener('click', (event) => {
                event.stopPropagation();
                const rect = shootingStar.getBoundingClientRect();
                const x = event.clientX - rect.left + shootingStar.offsetLeft;
                const y = event.clientY - rect.top + shootingStar.offsetTop;
                const secretWish = prompt("Make a secret wish upon this shooting star!");
                if (secretWish && secretWish.trim() !== "") {
                    // Display the wish text
                    const wishText = document.createElement('div');
                    wishText.className = 'wish-text';
                    wishText.style.left = `${x}px`;
                    wishText.style.top = `${y}px`;
                    wishText.textContent = secretWish;
                    document.getElementById('interactive-area').appendChild(wishText);
                    wishCounter++;
            
                    // Fade in the wish text
                    setTimeout(() => {
                        wishText.style.opacity = 1;
                    }, 100);
            
                    // Remove the wish text after some time
                    setTimeout(() => {
                        wishText.style.opacity = 0;
                        setTimeout(() => {
                            wishText.remove();
                        }, 2000); // Make sure this duration matches the CSS transition
                    }, 5000);
                }
                shootingStar.remove(); // Remove the shooting star after click
            });
            

            setTimeout(() => {
                shootingStar.remove();
            }, 2000);
        }

        setInterval(createShootingStar, 10000);

        // Audio logic with Mute Button
        const backgroundMusic = document.getElementById("backgroundMusic");
        const speakerIcon = document.getElementById("speakerIcon");
        const muteIcon = document.getElementById("muteIcon");
        let isMuted = false;

        // Function to toggle mute state
               // Function to toggle mute state
        function toggleMute() {
            isMuted = !isMuted;
            backgroundMusic.muted = isMuted;

            // Toggle the speaker and mute icons
            speakerIcon.style.display = isMuted ? "none" : "block";
            muteIcon.style.display = isMuted ? "block" : "none";
        }

        // Event listener for the mute button
        const toggleMusicButton = document.getElementById("toggleMusic");
        toggleMusicButton.addEventListener("click", toggleMute);

        // Share Sky Button Logic (Modified)
        document.getElementById('shareSky').addEventListener('click', () => {
            const location = userLocation || 'Unknown';
            const date = new Date().toLocaleDateString();
            const numDreams = dreamTexts.length; // Number of dreams/stars added
            const numWishes = wishCounter;
            const zodiacRevealed = revealedConstellations;
            const userName = userNames[0] || 'Mysterious Star';

            let shareText = `Our Sky on ${date} - ${location}\n\n`;
            shareText += `✨ ${userName} sees ${numDreams} dreams shining bright.\n`;
            shareText += `🌠 ${numWishes} wishes made on shooting stars.\n`;
            shareText += `\n🌌 The constellations are aligning, revealing:\n`;
            if (zodiacRevealed.length > 0) {
                zodiacRevealed.forEach(zodiac => {
                    shareText += `- ${zodiac}\n`;
                });
            } else {
                shareText += "The cosmos holds its secrets...\n";
            }

            // Create a temporary textarea to copy the text
            const tempTextarea = document.createElement('textarea');
            tempTextarea.value = shareText;
            document.body.appendChild(tempTextarea);
            tempTextarea.select();
            document.execCommand('copy');
            document.body.removeChild(tempTextarea);

            alert('Your Sky Summary has been copied to the clipboard! Share it with your loved one or on social media.');
        });

        // Get user's approximate location using IP geolocation (replace with your API key)
        let userLocation = '';
        fetch('https://ipinfo.io/json?token=79d95759d7af8e') // Replace 'YOUR_API_KEY' with your actual API key from ipinfo.io
            .then(response => response.json())
            .then(data => {
                if (data.city && data.region) {
                    userLocation = `${data.city}, ${data.region}`;
                } else {
                    userLocation = 'Unknown';
                }
            })
            .catch(error => {
                console.error('Error fetching location:', error);
                userLocation = 'Unknown';
            });

        // Zodiac Constellation Reveal Logic

        const constellationCanvas = document.getElementById('constellation-canvas');
        const constellationCtx = constellationCanvas.getContext('2d');
        constellationCanvas.width = window.innerWidth;
        constellationCanvas.height = window.innerHeight;

        const constellationData = {
            Aries: {
                stars: [[100, 200], [150, 250], [180, 230]],
                lines: [[0, 1], [1, 2]]
            },
            Taurus: {
                stars: [[300, 100], [350, 150], [380, 130], [420, 180]],
                lines: [[0, 1], [1, 2], [2, 3]]
            },
            Gemini: {
                stars: [[500, 200], [550, 250], [580, 230], [620, 280]],
                lines: [[0, 1], [1, 2], [2, 3]]
            },
            Cancer: {
                stars: [[100, 400], [150, 350], [180, 370], [220, 320]],
                lines: [[0, 1], [1, 2], [2, 3]]
            },
            Leo: {
                stars: [[300, 500], [350, 450], [380, 470], [420, 420]],
                lines: [[0, 1], [1, 2], [2, 3]]
            },
            Virgo: {
                stars: [[500, 600], [550, 550], [580, 570], [620, 520]],
                lines: [[0, 1], [1, 2], [2, 3]]
            },
            Libra: {
                stars: [[700, 200], [750, 250], [780, 230], [820, 280]],
                lines: [[0, 1], [1, 2], [2, 3]]
            },
            Scorpio: {
                stars: [[900, 100], [950, 150], [980, 130], [1020, 180]],
                lines: [[0, 1], [1, 2], [2, 3]]
            },
            Sagittarius: {
                stars: [[1100, 200], [1150, 250], [1180, 230], [1220, 280]],
                lines: [[0, 1], [1, 2], [2, 3]]
            },
            Capricorn: {
                stars: [[700, 400], [750, 350], [780, 370], [820, 320]],
                lines: [[0, 1], [1, 2], [2, 3]]
            },
            Aquarius: {
                stars: [[900, 500], [950, 450], [980, 470], [1020, 420]],
                lines: [[0, 1], [1, 2], [2, 3]]
            },
            Pisces: {
                stars: [[1100, 600], [1150, 550], [1180, 570], [1220, 520]],
                lines: [[0, 1], [1, 2], [2, 3]]
            }
        };
        
        let revealedConstellations = [];

        function revealConstellation(name, index) {
            const constellation = constellationData[name];
            constellationCtx.strokeStyle = 'rgba(255, 255, 255, 1)';
            constellationCtx.lineWidth = 2;
            constellationCtx.shadowColor = 'white';
            constellationCtx.shadowBlur = 10;
        
            let starIndex = 0;
            let lineIndex = 0;
        
            function animateStar() {
                if (starIndex < constellation.stars.length) {
                    const star = constellation.stars[starIndex];
                    drawHighlightedStar(star[0], star[1], constellationCtx);
                    starIndex++;
                    setTimeout(animateStar, 500); // Delay between each star
                } else {
                    animateLine(); // Start animating lines after stars
                }
            }
        
            function animateLine() {
                if (lineIndex < constellation.lines.length) {
                    const line = constellation.lines[lineIndex];
                    drawLineWithAnimation(constellation.stars[line[0]], constellation.stars[line[1]], constellationCtx);
                    lineIndex++;
                    setTimeout(animateLine, 500); // Delay between each line
                }
            }
        
            animateStar();
        
            revealedConstellations.push(name); // Add to revealed list
        }        
        
        function drawHighlightedStar(x, y, ctx) {
            const numPoints = 5;
            const outerRadius = 5;
            const innerRadius = 2.5;
            ctx.beginPath();
            ctx.moveTo(x, y - outerRadius);
            for (let i = 0; i < numPoints * 2; i++) {
                const radius = i % 2 === 0 ? outerRadius : innerRadius;
                const angle = (i * Math.PI) / numPoints;
                const pointX = x + radius * Math.sin(angle);
                const pointY = y - radius * Math.cos(angle);
                ctx.lineTo(pointX, pointY);
            }
            ctx.closePath();
            ctx.fillStyle = 'white';
            ctx.fill();
        }
        
        function drawLineWithAnimation(start, end, ctx) {
            ctx.strokeStyle = 'white';
            ctx.lineWidth = 2;
            ctx.shadowColor = 'white';
            ctx.shadowBlur = 5;
        
            let currentPoint = { x: start[0], y: start[1] };
            const deltaX = (end[0] - start[0]) / 50; // 50 steps for animation
            const deltaY = (end[1] - start[1]) / 50;
        
            function animate() {
                ctx.beginPath();
                ctx.moveTo(currentPoint.x, currentPoint.y);
                currentPoint.x += deltaX;
                currentPoint.y += deltaY;
                ctx.lineTo(currentPoint.x, currentPoint.y);
                ctx.stroke();
        
                if (Math.abs(currentPoint.x - end[0]) > Math.abs(deltaX) || Math.abs(currentPoint.y - end[1]) > Math.abs(deltaY)) {
                    requestAnimationFrame(animate);
                } else {
                    ctx.shadowColor = 'transparent';
                    ctx.shadowBlur = 0;
                }
            }
        
            animate();
        }
        
        
        
        function revealConstellationsGradually() {
            const constellationNames = Object.keys(constellationData);
            let constellationIndex = 0;
            let totalConstellations = constellationNames.length;
        
            const revealNextConstellation = () => {
                if (constellationIndex < totalConstellations) {
                    revealConstellation(constellationNames[constellationIndex], constellationIndex);
                    constellationIndex++;
                    setTimeout(revealNextConstellation, 24 * 60 * 60 * 1000 / totalConstellations); // Calculate delay based on total number
                }
            };
        
            revealNextConstellation();
        }        
        
        // Function to manage the drawing, event listeners, and reveal process
        function initializeDrawingCanvas() {
            // Other initializations...
        
            // Start the gradual reveal of constellations
            revealConstellationsGradually();
        }

        // Call this function to start the app
        initializeDrawingCanvas();

        let userNames = []; // Array to store user names
        
        function askForName(promptMessage) {
            const name = prompt(promptMessage);
            if (name && name.trim() !== "") {
                userNames.push(name);
            } else {
                alert("Please enter a valid name.");
                askForName(promptMessage); // Re-prompt if the name is not valid
            }
        }

        function askUserName() {
            const names = ['first', 'second'];

            names.forEach((value, index) => {
                askForName(`Please enter the ${value} name:`);
            });
        }
        
        askUserName();
    </script>
</body>
</html>
